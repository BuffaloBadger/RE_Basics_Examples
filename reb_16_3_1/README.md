This was adapted from AFCoKaRE Example 30.1
