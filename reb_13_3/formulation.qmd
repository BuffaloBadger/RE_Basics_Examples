---
format:
  html:
    toc: false
    embed-resources: true
---

```{r}
#| echo: false
#| output: false
library(tidyverse)
library(knitr)
library(kableExtra)
source('~/Libraries/R/fmt_tibble_col.R')
```

### Example 13-3

{{< include problem_statement.qmd >}}

```{r}
#| echo: false
#| output: false
path_to_data <- './Data/'
path_to_results <- './Results/'
path_to_figures <- './Results/'
```

---

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

This assignment describes a single BSTR and no other reactors, heat exchangers, or stream mixing/splitting points. It describes the reactor, its operation, and the reactions taking place, including the rate expressions. It asks me to find a reaction time to maximize yield. From these characteristics, I know that this is an isolated reactor modeling assignment. I know the general approach to completing an isolated reactor modeling assignment that was described in @sec-5_response_opt_design has five basic steps.

1. Summarize the information provided in the assignment.
2. Formulate the solution mathematically.
3. Implement the solution numerically.
4. Execute the solution.
5. Report and comment upon the results.

To summarize the information provided in the assignment I'll read through the problem and extract the following information:

1. Summarize the information provided in the assignment.
	a. Reactor type and operational mode
	b. Constant quantities
	c. Adjusted quantities
	d. Missing reactor input or process parameter and specified reactor response
	e. Quantities of interest

:::

**Information Provided in the Assignment**

**Reactor**: BSTR with heat transfer

**Given Constants**: $P_{A,0}$ = 1 atm, $P_{B,0}$ = 2 atm, $T_0$ = 25 °C, $V$ = 2 L, $A$ = 600 cm^2^, $U$ = 0.6 cal cm^-2^ min^-1^ K^-1^, $T_{ex}$ = 30 °C, $k_{0,1}$ =  3.34 x 10^9^ mol cm^-3^ min^-1^ atm^-2^, $k_{0,2}$ = 4.99 x 10^9^ mol cm^-3^ min^-1^ atm^-2^, $E_1$ = 20.5 kcal mol^-1^, $E_2$ = 21.8 kcal mol^-1^, $\Delta H_1$ = -6,300 cal mol^-1^, $\Delta H_2$ = -6,900 cal mol^-1^, $\hat C_{p,A}$ = 7.4 cal mol^-1^ K^-1^, $\hat C_{p,B}$ = 8.6 cal mol^-1^ K^-1^, $\hat C_{p,D}$ = 10.7 cal mol^-1^ K^-1^, $\hat C_{p,Z}$ = 5.2 cal mol^-1^ K^-1^ and $\hat C_{p,U}$ = 10.3 cal mol^-1^ K^-1^.

**Quantities of Interest**: $t_{rxn,opt} = \underset{t}{\arg\max} \left(Y_{D/A}\right)$, $\underset{t}\max \left(Y_{D/A}\right)$, and $f_A\Big\vert_{t_{rxn,opt}}$.

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

The second basic step for completing an isolated BSTR modeling assignment is to formulate the solution mathematically. From my reading of this chapter, I know, generally, how to do this.

2. Formulate the solution mathematically.
	a. Choose, write and simplify the reactor design equations needed to model the reactor.
	b. Identify the independent variable and the dependent variables, and ensure that the number of dependent variables is equal to the number of reactor design equations.
	c. Specify the initial values and the stopping criterion, and write equations for calculating their values.
	d. Write equations to express every quantity appearing in the reactor design equations or in equations that will be substituted into the reactor design equations in terms of known constants, the independent variable, the dependent variables, the missing reactor input or process parameter (if there is one), and the adjusted quantities (if there are any).
	e. Write the equations to calculate every quantity of interest and the response that was specified in the assignment (if there is one) using the results from solving the reactor design equations, the independent variable, the dependent variables, the missing reactor input or process parameter (if there is one), and the adjusted quantities (if there are any).
	f. Briefly explain or outline the sequence of calculations that must be used to calculate and process the quantities of interest (and the response that was specified in the assignment, if there is one).

:::

**Mathematical Formulation of the Solution**

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

Mole balances are always included in the reactor design equations. The general BSTR mole balance is given in @eq-bstr_mole_balance. I will use this equation to write mole balances for every reagent in the system. That is, I'll write the mole balance for $i$ = A, B, D, Z, and U. There are two reactions taking place, so the sum will expand to two terms in each mole balance.

$$
\frac{dn_i}{dt} = V \sum_j \nu_{i,j}r_j = \left( \nu_{i,1}r_1 + \nu_{i,2}r_2 \right)V
$$

This reactor is not isothermal, so I will need to include a BSTR reacting fluid energy balance among the reactor design equations. The BSTR energy balance is given in @eq-bstr_energy_balance. This reactor has rigid walls and no moving boundaries, so it's volume is constant. If the volume is constant, the time-derivative of the volume is equal to zero. Being a gas phase system with a constant volume, the pressure is expected to change because the temperature will change. Therefore I *cannot* set the time-derivative of the pressure equal to zero. With no moving boundaries, the only work is that of the agitator, which is assumed to be negligible.  The summation over $i$ includes every reagent, and as above, the summation over $j$ expands to two terms.

$$
\left(\sum_i n_i \hat C_{p,i} \right) \frac{dT}{dt} - V\frac{dP}{dt}  - P  \cancelto{0}{\frac{dV}{dt}}  = \dot Q - \cancelto{0}{\dot W} - V \cancelto{\left( r_1 \Delta H_1 + r_2 \Delta H_2\right)}{\sum_j \left(r_j \Delta H_j \right)}
$$

$$
\left( n_A \hat C_{p,A} + n_B \hat C_{p,B} + n_D \hat C_{p,D} + n_Z \hat C_{p,Z} + n_U \hat C_{p,U}  \right) \frac{dT}{dt} - V\frac{dP}{dt}  = \dot Q - \left( r_1 \Delta H_1 + r_2 \Delta H_2\right)V
$$

An exchange fluid is present in this reactor, but the assignment states that its temperature is constant at 30 °C. Knowing the exchange fluid temperature, the other reactor design equations can be solved independently of an energy balance on the exchange fluid, so I do not need to include an energy balance on the exchange fluid among the reactor design equations.

:::

**Reactor Design Equations**

Mole balances of each of the reagents are presented in equations (5) through (9), and an energy balance on the reacting fluid is presented in equation (10).

$$
\frac{dn_A}{dt} = -r_1V \tag{5}
$$

$$
\frac{dn_B}{dt} = \left( -r_1 - r_2 \right)V \tag{6}
$$

$$
\frac{dn_D}{dt} = \left( r_1 - r_2 \right)V \tag{7}
$$

$$
\frac{dn_Z}{dt} = \left( r_1 + r_2 \right)V \tag{8}
$$

$$
\frac{dn_U}{dt} = r_2V \tag{9}
$$

$$
\begin{aligned}
- V\frac{dP}{dt} + &\left( n_A \hat C_{p,A} + n_B \hat C_{p,B} + n_D \hat C_{p,D} + n_Z \hat C_{p,Z} + n_U \hat C_{p,U}  \right) \frac{dT}{dt} \\&= \dot Q  - \left( r_1 \Delta H_1 + r_2 \Delta H_2\right)V
\end{aligned} \tag{10}
$$

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

At this point I have 6 initial value ordinary differential equations (IVODEs) that contain 7 dependent variables ($n_A$, $n_B$, $n_D$, $n_Z$, $n_U$, $P$, and $T$). I either need to eliminate a dependent variable or add an IVODE before I can solve the reactor design equations.

Noting that V is constant, I'm going to take the time-derivative of the ideal gas law and use it as an additional IVODE.

$$
PV - \left(n_A + n_B + n_D + n_Z + n_U \right)RT =0
$$

$$
\begin{aligned}
V\frac{dP}{dt} &- RT\left(\frac{dn_A}{dt} + \frac{n_B}{dt} + \frac{n_D}{dt} + \frac{n_Z}{dt} + \frac{n_U}{dt} \right) \\&- R\left(n_A + n_B + n_D + n_Z + n_U \right)\frac{dT}{dt} = 0
\end{aligned}
$$

:::

Taking the derivative of the ideal gas law yields equation (11).

$$
\begin{aligned}
- &RT\left(\frac{dn_A}{dt} + \frac{n_B}{dt} + \frac{n_D}{dt} + \frac{n_Z}{dt} + \frac{n_U}{dt} \right) + V\frac{dP}{dt} \\&- R\left(n_A + n_B + n_D + n_Z + n_U \right)\frac{dT}{dt} = 0
\end{aligned}\tag{11}
$$

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

I now have 7 IVODEs with 7 dependent variables. Initial values and a stopping criterion are needed in order to solve these equations. I can define $t=0$ to be instant that the A and B are added to the reactor, and let $n_{A,0}$, $n_{B,0}$, $P_0$, and $T_0$ represent the molar amounts of A and B, the pressure, and the temperature at that instant. The initial molar amounts of A and B are not given, but their initial partial pressures are. Consequently, the initial molar amounts of A and B can be calculated using the ideal gas law. Initially the reactor does not contain D, Z, or U, so the initial molar amounts of those reagents are equal to zero. The initial temperature is given and the initial pressure can be calculated using the initial partial pressures of the reagents given in the assignment.

The assignment asks for the reaction time that will maximize the yield, so I need to vary the reaction time over a range of values, as indicated in the information summary. Because the reaction time is the independent variable, I do not need to solve the design equations many times using different values of the reaction time. Instead, I can set the reaction time to a large value and use it as the stopping criterion, $t=t_{rxn}$. Solving the design equations will yield $n_A\left(t\right)$, $n_B\left(t\right)$, $n_D\left(t\right)$, $n_Z\left(t\right)$, $n_U\left(t\right)$, $P\left(t\right)$, and $T\left(t\right)$, from which I can calculate $Y_{D/A}\left(t\right)$ (see below). If the yield does not exhibit a maximum at times between $t=0$ and $t=t_{rxn}$, I'll need to set the reaction time to a larger value and repeat the calculations.

:::

The initial values and stopping criterion for solving equations (5) through (11) are presented in @tbl-example_13_3_initial_values. The initial molar amounts of A and B can be calculated using equations (12) and (13), and the initial total pressure is the sum of the initial partial pressures, equation (14). The reaction time needs to be adjusted to find the time that maximizes the yield. Consequently, a value can be chosen for $t_{rxn}$. Doing so will yield results that span times from zero to the chosen value when the equations are solved numerically.

| Variable | Initial Value | Stopping Criterion |
|:-------|:-------:|:-------:|
| $t$ | $0$ | $t_{rxn}$ |
| $n_A$ | $n_{A,0}$ | |
| $n_B$ | $n_{B,0}$ | |
| $n_D$ | $0$ | |
| $n_Z$ | $0$ | |
| $n_U$ | $0$ | |
| $P$ | $P_0$ | |
| $T$ | $T_0$ | |
  
: Initial values and stopping criterion for solving the design equations, (5) through (11). {#tbl-example_13_3_initial_values}

$$
n_{A,0} = \frac{P_{A,0}V}{RT} \tag{12}
$$

$$
n_{B,0} = \frac{P_{B,0}V}{RT} \tag{13}
$$

$$
P_0 = P_{A,0} + P_{B,0} \tag{14}
$$

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

The design equations cannot be solved until every quantity appearing in them and every quantity substituted into them is expressed in terms of known constants, the independent variable and the dependent variables. Looking at the quantities in the IVODEs, $V$, $\hat C_{p,A}$, $\hat C_{p,B}$, $\hat C_{p,D}$, $\hat C_{p,Z}$, $\hat C_{p,U}$, $\Delta H_1$, $\Delta H_2$, and the gas constant, $R$, are known constants. That leaves the reaction rates and the rate of heat transfer to be expressed in terms of known constants, the independent variable, $t$, and the dependent variables, $n_A$, $n_B$, $n_D$, $n_Z$, $n_U$, $T$, and $P$.

The reaction rates are given by equations (3) and (4). Substituting the rate expressions into the reactor design equations introduces the known constants, $k_{0,1}$, $k_{0,2}$, $E_1$, and $E_2$, along with the partial pressures of A, B, and D. The partial pressures can be calculated using the ideal gas law.

The rate of heat transfer, $\dot{Q}$, can be expressed in terms of $T$ and the known, constant heat transfer coefficient, $U$, heat transfer area, $A$, and exchange fluid temperature, $T_{ex}$, @eq-bstr_heat_transfer.

:::

**Ancillary Equations for Solving the Reactor Design Equations**

$$
P_A = \frac{n_ART}{V} \tag{15}
$$

$$
P_B = \frac{n_BRT}{V} \tag{16}
$$

$$
P_D = \frac{n_DRT}{V} \tag{17}
$$

$$
\dot Q = UA\left( T_{ex} - T \right) \tag{18}
$$

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

With the information provided above, the design equations can be solved for $n_A\left(t\right)$, $n_B\left(t\right)$, $n_D\left(t\right)$, $n_Z\left(t\right)$, $n_U\left(t\right)$, $P\left(t\right)$, and $T\left(t\right)$. The quantities of interest in the assignment are the reaction time that mazimizes the yield of D and the yield of D and the conversion of A at that reaction time. Using the results from solving the design equations, the yield and conversion as functions of time can be calculated using their definitions.

:::

**Ancillary Equations for Calculating the Quantities of Interest**

$$
Y_{D/A} = \frac{n_D}{n_{A,0}} \tag{19}
$$

$$
f_A=\frac{n_{A,0}-n_A}{n_{A,0}} \tag{20}
$$

**Sequence of Calculations to Complete the Assignment**

1. Choose a value for $t_{rxn}$.
2. Substitute given and known constants into all equations.
3. Substitute equations (15) and (16) into equation (3).
4. Substitute equations (16) and (17) into equation (4).
5. Substitute equations (3), (4), and (18) into equations (5) through (11).
6. Calculate $n_{A,0}$, $n_{B,0}$, and $P_0$ using equations (12), (13), and (14).
7. Solve equations (5) through (11) using the initial values and stopping criterion in @tbl-example_13_3_initial_values to get $n_A\left(t\right)$, $n_B\left(t\right)$, $n_D\left(t\right)$, $n_Z\left(t\right)$, $n_U\left(t\right)$, $P\left(t\right)$ and $T\left(t\right)$ at reaction times between 0 and $t_{rxn}$.
8. Use the results to calculate $Y_{D/A}\left(t\right)$ and $f_A\left(t\right)$ using equations (19) and (20).
9. Find $\underset{t}\max \left(Y_{D/A}\right)$, $t_{rxn,opt} = \underset{t}{\arg\max} \left(Y_{D/A}\right)$, and $f_A\Big\vert_{t_{rxn,opt}}$.
	a. If $Y_{D/A}\left(t\right)$ does not pass through a maximum between $t=0$ and $t=t_{rxn}$, repeat from step 1 using a larger value of $t_{rxn}$.
	b. If there is a maximum between $t=0$ and $t=t_{rxn}$, $\underset{t}\max \left(Y_{D/A}\right)$, $t_{rxn,opt} = \underset{t}{\arg\max} \left(Y_{D/A}\right)$, and $f_A\Big\vert_{t_{rxn,opt}}$ are the quantities of interest.

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

Having formulated the solution mathematically, the third basic step for completing an isolated reactor modeling assignment is to implement the solution numerically. I know that this will entail creating two computer functions.

3. Implement the solution numerically.
	a. Create a response function.
		i. Pass the missing value (if there is one) and the adjusted values (if there are any) to it as arguments.
		ii. Solve the reactor design equations for each set of adjusted values.
		iii. Calculate and return the quantities of interest (and the specified response if there is one) corresponding to each set of adjusted values.
	b. Create a calculations function.
		i. Perform the sequence of calculations that is needed to calculate the quantities of interest, calling or using the response function as needed.
		ii. Process the quantities of interest as necessary to complete the assignment.

:::

**Numerical Implementation of the Solution**

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

I know that the purpose of the response function is to calculate the quantities of interest. In this assignment there isn't a missing reactor input or process parameter. That means that the response function will not have a missing value argument.

There is an adjusted value, namely $t$. However, in this assignment I do not need to pass a range of values of $t$ to the response function. I can simply pass a value for $t_{rxn}$ because the IVODE solver will generate a range of values between $t = 0$ and $t=t_{rxn}$ as it solves the IVODEs.

The response function must complete steps 2 through 8 in the sequence given above and then return a vector containing the range of values of $t$ and vectors containing the correponding values of $Y_{D/A}$ and $f_A$.

:::

**Response Function**

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

I know that in order to solve the design equations numerically I will need to calculate the values of the derivatives, $\frac{dn_A}{dt}$, $\frac{dn_B}{dt}$, $\frac{dn_D}{dt}$, $\frac{dn_Z}{dt}$, $\frac{dn_U}{dt}$, $\frac{dP}{dt}$, and $\frac{dT}{dt}$, given values of the independent variable and the dependent variables. I can do that either of two ways as described in @sec-apndx_solve_ivodes. One way is to algebraically manipulate equations (5) through (11) to put them in the form of a vector equation, Equations [-@eq-example-vector-ode-1] through [-@eq-example-vector-ode-4]. The other way is to write them in the form of a matrix equation, @eq-matrix-form-ivode. Here I will write the IVODEs as a matrix equation.

:::

The design equations can be written as the matrix equation, (21), where the mass matrix, $\boldsymbol{M}$, is defined as shown in equation (22). The values of the derivatives, $\frac{dn_A}{dt}$, $\frac{dn_B}{dt}$, $\frac{dn_D}{dt}$, $\frac{dn_Z}{dt}$, $\frac{dn_U}{dt}$, $\frac{dP}{dt}$, and $\frac{dT}{dt}$, then can be calculated using equation (23).

$$
\boldsymbol{M} \frac{d}{dt}\begin{bmatrix} \frac{dn_A}{dt} \\ \frac{dn_B}{dt} \\  \frac{dn_D}{dt} \\
\frac{dn_Z}{dt} \\ \frac{dn_U}{dt} \\ \frac{dP}{dt} \\ \frac{dT}{dt} \end{bmatrix} =  \begin{bmatrix} -r_1V \\ \left(-r_1 -r_2\right)V \\ \left(r_1 -r_2\right)V \\ \left(r_1 +r_2\right)V \\ r_2V \\ \dot Q  - \left( r_1 \Delta H_1 + r_2 \Delta H_2\right)V \\ 0 \end{bmatrix} \tag{21}
$$

$$
\boldsymbol{M} = \begin{bmatrix} 1 & 0 & 0 & 0 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 1 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 1 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & -V & \sum_i n_i \hat C_{p,i} \\
-RT & -RT & -RT & -RT & -RT & V & -R \sum_i n_i   \end{bmatrix} \tag{22}
$$

$$
\frac{d}{dt}\begin{bmatrix} \frac{dn_A}{dt} \\ \frac{dn_B}{dt} \\  \frac{dn_D}{dt} \\
\frac{dn_Z}{dt} \\ \frac{dn_U}{dt} \\ \frac{dP}{dt} \\ \frac{dT}{dt} \end{bmatrix} = \boldsymbol{M}^{-1} \begin{bmatrix} -r_1V \\ \left(-r_1 -r_2\right)V \\ \left(r_1 -r_2\right)V \\ \left(r_1 +r_2\right)V \\ r_2V \\ \dot Q  - \left( r_1 \Delta H_1 + r_2 \Delta H_2\right)V \\ 0 \end{bmatrix} \tag{23}
$$

**Response Function**

The response function is created with the following structure:

* It is passed a value of $t_{rxn}$ as an argument.
* It defines variables and assigns values to them for all known and given quantities.
* It sets the initial values and stopping criterion according to @tbl-example_13_3_initial_values and equations (12), (13), and (14).
* In preparation for solving the IVODEs, it defines a function to evaluate $\frac{dn_A}{dt}$, $\frac{dn_B}{dt}$, $\frac{dn_D}{dt}$, $\frac{dn_Z}{dt}$, $\frac{dn_U}{dt}$, $\frac{dP}{dt}$, and $\frac{dT}{dt}$ using equations (22) and (23). That function
  * receives values for $t$, $n_A$, $n_B$, $n_D$, $n_Z$, $n_U$, $P$, and $T$,
  * calculates $P_A$, $P_B$, $P_D$, and $\dot{Q}$ using equations (15) through (18),
  * calculates $r_1$ and $r_2$ using equations (3) and (4),
  * calculates $\boldsymbol{M}$ using equation (22), and
  * calculates and returns $\frac{dn_A}{dt}$, $\frac{dn_B}{dt}$, $\frac{dn_D}{dt}$, $\frac{dn_Z}{dt}$, $\frac{dP}{dt}$, and $\frac{dT}{dt}$ using equation (23).
* The response function next calls an IVODE solver to solve equations (5) through (11) and get vectors containing values for $t$, $n_A$, $n_B$, $n_D$, $n_Z$, $n_U$, $P$, and $T$, passing the function above and the initial values and stopping criterion in @tbl-example_13_2_initial_values as arguments.
* It calculates vectors containing $Y_{D/A}$ and $f_A$ using the results from the IVODE solver and equations (19) and (20).
* Finally, it returns the vectors containing $t$, $Y_{D/A}$, and $f_A$.

:::{.callout-tip collapse="true"}
## Click Here to See What an Expert Might be Thinking at this Point

The calculations function is responsible for performing the entire sequence of calculations listed at the end of the mathematical formulation. After setting a value for the reaction time, it can perform steps 2 through 8 by simply calling the response function.

:::

**Calculations Function**

The calculations function is created with the following structure:

* It does not accept any arguments.
* It defines a variable and sets a value for $t_{rxn}$.
* It calls the response function, passing that variable as an argument.
    * The response function returns vectors containing $t$, $Y_{D/A}$, and $f_A$ that span the range from $t=0$ to $t=t_{rxn}$.
* It finds the maximum value of $Y_{D/A}$ and the corresponding values of $t$ and $f_A$.
* It checks that the maximum occurs at a time between $t=0$ to $t=t_{rxn}$.
	* If it does, it reports the maximum value of $Y_{D/A}$ and the corresponding values of $t$ and $f_A$, and saves the results to a file.
	* If it does not, it reports that there wasn't a maximum value between $t=0$ to $t=t_{rxn}$ and suggests using a larger value for $t_{rxn}$.

**Performing the Calculations**

After creating the response function and calculations function as described, all of the calculations needed to complete the assignment can be performed by executing the calculations function.

**Results**

```{r}
#| echo: false
#| output: false
df <- read.csv(paste0(path_to_results,'reb_13_3_results.csv'))
```

@fig-example_13_3_yield_plot shows the yield *vs*. reaction time. The maximum yield, `r df$value[2]``r df$units[2]`, occurs at a reaction time of `r df$value[1]` `r df$units[1]`. The conversion of A at that reaction time is `r df$value[3]``r df$units[3]`.

![Yield of D as the reaction time varies.](`r paste0(path_to_figures,'reb_13_3_yield_plot.png')`){#fig-example_13_3_yield_plot width="80%"}

**Summary**

Reactions (1) and (2) constitute a series-parallel reaction network. The desired product, D, is an intermediate product. It is produced in reaction (1) and consumed in reaction (2). Assuming that the temperature affects the two reactions equally, the yield of an intermediate product is expected to pass through a maximum as the reaction time increases as seen in @fig-example_13_3_yield_plot. This can be predicted using a quantitative analysis

**Qualitative Analysis**

The reason for the maximum is qualitatively easy to understand as long as the effect of temperature is comparable for the two reactions. At the start of the reaction, the concentrations a A and B will be large and those of D, U, and Z will be small. The rate of reaction (1) will be positive while that for reaction (2) will be zero. Consequently, during a very brief interval at the start of the reaction, the concentrations of A and B will decrease and the concentrations of D and Z will increase.

During the next brief interval in time, the rate of reaction (1) will be smaller because the concentrations of A and B will be smaller, and the rate of reaction (2) no longer will equal zero because a small amount D will be present leading to a positive rate. The concentrations of A and B will again decrease and the concentration of Z will again increase. During this second brief interval it can be expected that the rate of reaction (1) will be greater than the rate of reaction (2) because only a small concentration of D will be present. Hence during the second small interval of time, the concentration of D will again increase, as can be seen in @fig-example_13_3_yield_plot. 

For as long as the rate of reaction (2) remains smaller than the rate of reaction (1), the amount of D will be increasing, but its rate of increase will get smaller and smaller. The reason for this is that the concentrations of A and B will be decreasing, and hence the rate of reaction (1) will be decreasing. At the same time, the rate of reaction (2) will be increasing as the concentration of D builds. This can be seen in @fig-example_13_3_yield_plot where the curvature of the yield plot is initially concave downward,

Eventually, the rate of reaction (2) will become equal to the rate of reaction (1). For that instant in time, the yield of D will not be changing. This corresponds to the maximum in @fig-example_13_3_yield_plot. At times beyond the maximum the rate of reaction (1) is less than the rate of reaction (2), so the concentration of D decreases. As the concentrations of both reactants, A and D, continue to decrease, both reactions (1) and (2) become slower and slower. This can be seen at larger reaction times in @fig-example_13_3_yield_plot where the curve is concave upward. Eventually, at very large reaction time, the rates will equal zero and all of the D will have been consumed.

[add note showing how dP/dt can be eliminated algbraically]

[add note about reaction time being a primary parameter for adjusting the amount of an intermediate product in a series reaction network, noting that other parameters will also affect it.]